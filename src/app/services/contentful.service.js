"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var http_1 = require("@angular/common/http");
var core_1 = require("@angular/core");
var marked = require("marked");
var rxjs_1 = require("rxjs");
var operators_1 = require("rxjs/operators");
var environment_prod_1 = require("../../environments/environment.prod");
var settings_service_1 = require("./settings.service");
var event_item_model_1 = require("../models/event-item.model");
var info_item_model_1 = require("../models/info-item.model");
var simple_content_model_1 = require("../models/simple-content.model");
var speaker_model_1 = require("../models/speaker.model");
var workshop_model_1 = require("../models/workshop.model");
var dialog = require("ui/dialogs");
var EventContentTypes;
(function (EventContentTypes) {
    EventContentTypes["SPEAKER"] = "speaker";
    EventContentTypes["WORKSHOP"] = "workshop";
    EventContentTypes["EVENT_ITEM"] = "eventItem";
    EventContentTypes["SIMPLE_CONTENT"] = "simpleContent";
    EventContentTypes["INFO_ITEM"] = "infoItem";
})(EventContentTypes = exports.EventContentTypes || (exports.EventContentTypes = {}));
var EventItemType;
(function (EventItemType) {
    EventItemType["NGPOLAND"] = "ngPoland";
    EventItemType["JSPOLAND"] = "jsPoland";
})(EventItemType = exports.EventItemType || (exports.EventItemType = {}));
var ContentfulService = /** @class */ (function () {
    function ContentfulService(settings, http) {
        this.settings = settings;
        this.http = http;
        this.CONTENTFUL_URL = "http://cdn.contentful.com";
        this.CONTENTFUL_URL_ENTRIES = this.CONTENTFUL_URL + "/spaces/" + environment_prod_1.environment.contentful.spaceId + "/environments/master/entries?access_token=" + environment_prod_1.environment.contentful.token;
    }
    ContentfulService.prototype.getContentfulUrlEntry = function (entryId) {
        return "http://cdn.contentful.com/spaces/" + environment_prod_1.environment.contentful.spaceId + "/environments/master/entries/" + entryId + "?access_token=" + environment_prod_1.environment.contentful.token;
    };
    ContentfulService.prototype.getContentfulUrlParameters = function (params) {
        return Object.entries(params)
            .map(function (_a) {
            var key = _a[0], val = _a[1];
            return key + "=" + val;
        })
            .join("&");
    };
    ContentfulService.prototype.getInfoItems = function (howMany) {
        var query = {
            content_type: EventContentTypes.INFO_ITEM,
            locale: this.settings.getLocale(),
            order: "fields.order",
            limit: howMany
        };
        return this.http
            .get(this.CONTENTFUL_URL_ENTRIES + "&" + this.getContentfulUrlParameters(query), { responseType: "json" })
            .pipe(operators_1.map(function (entries) {
            return entries.items.map(function (item) {
                return new info_item_model_1.InfoItem(item.fields.title, item.fields.ordre, item.fields.icon, item.fields.description, item.fields.urlLink);
            });
        }));
    };
    ContentfulService.prototype.getEventItems = function (howMany, type) {
        var _this = this;
        var query = {
            content_type: EventContentTypes.EVENT_ITEM,
            locale: this.settings.getLocale(),
            "fields.type": type,
            order: "fields.startDate",
            limit: howMany
        };
        return this.http
            .get(this.CONTENTFUL_URL_ENTRIES + "&" + this.getContentfulUrlParameters(query), { responseType: "json" })
            .pipe(operators_1.map(function (entries) {
            var assets = null;
            var links = null;
            if (entries.includes) {
                assets = entries.includes.Asset;
                links = entries.includes.Entry;
            }
            return entries.items.map(function (item) {
                var speaker = null;
                if (links && item.fields.presenter) {
                    speaker = _this.getEntryById(links, item.fields.presenter.sys.id);
                }
                var speakerPhoto = null;
                if (speaker) {
                    speakerPhoto = _this.getAssetById(assets, speaker.fields.photo.sys.id);
                }
                return new event_item_model_1.EventItem(item.fields.title, item.fields.type, item.fields.category, item.fields.shortDescription, item.fields.description, item.fields.startDate, item.fields.endDate, speaker
                    ? new speaker_model_1.Speaker(speaker.fields.name, speaker.fields.role, speaker.fields.bio, speakerPhoto ? speakerPhoto.fields.file.url : undefined, speakerPhoto ? speakerPhoto.fields.title : undefined, speakerPhoto ? speakerPhoto.fields.description : undefined, speaker.fields.email, speaker.fields.urlGithub, speaker.fields.urlLinkedIn, speaker.fields.urlTwitter, speaker.fields.urlWww)
                    : undefined);
            });
        }), operators_1.shareReplay(), operators_1.timeout(20000), operators_1.retryWhen(function (errors) {
            return errors.pipe(operators_1.delayWhen(function () { return rxjs_1.timer(2000); }), operators_1.tap(function () {
                console.log("retrying...");
                dialog.alert("Bład połaczenia");
            }));
        }));
    };
    ContentfulService.prototype.getSimpleContentById = function (myId) {
        var query = {
            content_type: EventContentTypes.SIMPLE_CONTENT,
            locale: this.settings.getLocale(),
            "fields.myId": myId,
            limit: 1
        };
        return this.http
            .get(this.CONTENTFUL_URL_ENTRIES + "&" + this.getContentfulUrlParameters(query), { responseType: "json" })
            .pipe(operators_1.map(function (entries) {
            if (entries && entries.items && entries.items[0]) {
                return new simple_content_model_1.SimpleContent(entries.items[0].fields.myId, entries.items[0].fields.title, entries.items[0].fields.text);
            }
            else {
                return new simple_content_model_1.SimpleContent("000", "nie udało się", "nie wyszło coś");
            }
        }));
    };
    ContentfulService.prototype.getWorkshops = function (howMany) {
        var _this = this;
        var query = {
            content_type: EventContentTypes.WORKSHOP,
            locale: this.settings.getLocale(),
            order: "sys.createdAt",
            limit: howMany
        };
        return this.http
            .get(this.CONTENTFUL_URL_ENTRIES + "&" + this.getContentfulUrlParameters(query), { responseType: "json" })
            .pipe(operators_1.map(function (entries) {
            var assets = entries.includes.Asset;
            var links = entries.includes.Entry;
            return entries.items.map(function (item) {
                //  const profilePhoto: Asset = this.getAssetById(assets, item.fields.photo.sys.id);
                var speaker = _this.getEntryById(links, item.fields.instructor.sys.id);
                // console.log("Spekaer: ", speaker);
                var speakerPhoto = _this.getAssetById(assets, speaker.fields.photo.sys.id);
                return new workshop_model_1.Workshop(item.fields.title, item.fields.description, new speaker_model_1.Speaker(speaker.fields.name, speaker.fields.role, speaker.fields.bio, speakerPhoto ? speakerPhoto.fields.file.url : undefined, speakerPhoto ? speakerPhoto.fields.title : undefined, speakerPhoto ? speakerPhoto.fields.description : undefined, speaker.fields.email, speaker.fields.urlGithub, speaker.fields.urlLinkedIn, speaker.fields.urlTwitter, speaker.fields.urlWww), item.fields.startDate, item.fields.endDate, 0, // TODO: zamienić na współrzędne
                0, // TODO: zamienić na współrzędne
                item.fields.locationDescription, item.fields.pricePln);
            });
        }));
    };
    ContentfulService.prototype.getSpeakers = function (howMany) {
        var _this = this;
        var query = {
            content_type: EventContentTypes.SPEAKER,
            locale: this.settings.getLocale(),
            order: "sys.createdAt",
            limit: howMany
        };
        return this.http
            .get(this.CONTENTFUL_URL_ENTRIES + "&" + this.getContentfulUrlParameters(query), { responseType: "json" })
            .pipe(operators_1.map(function (entries) {
            var assets = entries.includes.Asset;
            return entries.items.map(function (item) {
                var profilePhoto = _this.getAssetById(assets, item.fields.photo.sys.id);
                return new speaker_model_1.Speaker(item.fields.name, item.fields.role, item.fields.bio, profilePhoto ? profilePhoto.fields.file.url : undefined, profilePhoto ? profilePhoto.fields.title : undefined, profilePhoto ? profilePhoto.fields.description : undefined, item.fields.email, item.fields.urlGithub, item.fields.urlLinkedIn, item.fields.urlTwitter, item.fields.urlWww);
            });
        }));
    };
    ContentfulService.prototype.markdownToHtml = function (md) {
        return marked(md);
    };
    ContentfulService.prototype.getAssetById = function (assetArray, id) {
        if (assetArray && assetArray.length > 0) {
            var newArray = assetArray.filter(function (item) { return item.sys.id === id; });
            if (newArray && newArray.length > 0) {
                return newArray[0];
            }
        }
        return {};
    };
    ContentfulService.prototype.getAssetsByIds = function (assetArray, ids) {
        if (assetArray && assetArray.length > 0 && ids && ids.length > 0) {
            var newArray = assetArray.filter(function (item) {
                return ids.includes(item.sys.id);
            });
            return newArray;
        }
        return {};
    };
    ContentfulService.prototype.getEntryById = function (entriesArray, id) {
        if (entriesArray && entriesArray.length > 0) {
            var newArray = entriesArray.filter(function (item) { return item.sys.id === id; });
            if (newArray && newArray.length > 0) {
                return newArray[0];
            }
        }
        return {};
    };
    ContentfulService.prototype.getEntriesByContentType = function (entriesArray, contentType) {
        if (entriesArray && entriesArray.length > 0) {
            var newArray = entriesArray.filter(function (item) { return item.sys.contentType.sys.id === contentType; });
            if (newArray && newArray.length > 0) {
                return newArray;
            }
        }
        return {};
    };
    ContentfulService = __decorate([
        core_1.Injectable({
            providedIn: "root"
        }),
        __metadata("design:paramtypes", [settings_service_1.SettingsService, http_1.HttpClient])
    ], ContentfulService);
    return ContentfulService;
}());
exports.ContentfulService = ContentfulService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGVudGZ1bC5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY29udGVudGZ1bC5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsNkNBQWtEO0FBQ2xELHNDQUEyQztBQUUzQywrQkFBaUM7QUFDakMsNkJBQWdEO0FBQ2hELDRDQVF3QjtBQUN4Qix3RUFBa0U7QUFDbEUsdURBQXFEO0FBRXJELCtEQUF1RDtBQUN2RCw2REFBcUQ7QUFDckQsdUVBQStEO0FBQy9ELHlEQUFrRDtBQUNsRCwyREFBb0Q7QUFFcEQsbUNBQXFDO0FBRXJDLElBQVksaUJBTVg7QUFORCxXQUFZLGlCQUFpQjtJQUMzQix3Q0FBbUIsQ0FBQTtJQUNuQiwwQ0FBcUIsQ0FBQTtJQUNyQiw2Q0FBd0IsQ0FBQTtJQUN4QixxREFBZ0MsQ0FBQTtJQUNoQywyQ0FBc0IsQ0FBQTtBQUN4QixDQUFDLEVBTlcsaUJBQWlCLEdBQWpCLHlCQUFpQixLQUFqQix5QkFBaUIsUUFNNUI7QUFFRCxJQUFZLGFBR1g7QUFIRCxXQUFZLGFBQWE7SUFDdkIsc0NBQXFCLENBQUE7SUFDckIsc0NBQXFCLENBQUE7QUFDdkIsQ0FBQyxFQUhXLGFBQWEsR0FBYixxQkFBYSxLQUFiLHFCQUFhLFFBR3hCO0FBS0Q7SUFNRSwyQkFBb0IsUUFBeUIsRUFBVSxJQUFnQjtRQUFuRCxhQUFRLEdBQVIsUUFBUSxDQUFpQjtRQUFVLFNBQUksR0FBSixJQUFJLENBQVk7UUFMdEQsbUJBQWMsR0FBRywyQkFBMkIsQ0FBQztRQUM3QywyQkFBc0IsR0FBTSxJQUFJLENBQUMsY0FBYyxnQkFDOUQsOEJBQVcsQ0FBQyxVQUFVLENBQUMsT0FBTyxrREFDYSw4QkFBVyxDQUFDLFVBQVUsQ0FBQyxLQUFPLENBQUM7SUFFRixDQUFDO0lBRTNFLGlEQUFxQixHQUFyQixVQUFzQixPQUFlO1FBQ25DLE1BQU0sQ0FBQyxzQ0FDTCw4QkFBVyxDQUFDLFVBQVUsQ0FBQyxPQUFPLHFDQUNBLE9BQU8s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V0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFLEtBQUssV0FBVyxFQUEzQyxDQUEyQyxDQUNsRSxDQUFDO1lBQ0YsRUFBRSxDQUFDLENBQUMsUUFBUSxJQUFJLFFBQVEsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDcEMsTUFBTSxDQUFDLFFBQVEsQ0FBQztZQUNsQixDQUFDO1FBQ0gsQ0FBQztRQUVELE1BQU0sQ0FBQyxFQUFFLENBQUM7SUFDWixDQUFDO0lBbFVVLGlCQUFpQjtRQUg3QixpQkFBVSxDQUFDO1lBQ1YsVUFBVSxFQUFFLE1BQU07U0FDbkIsQ0FBQzt5Q0FPOEIsa0NBQWUsRUFBZ0IsaUJBQVU7T0FONUQsaUJBQWlCLENBbVU3QjtJQUFELHdCQUFDO0NBQUEsQUFuVUQsSUFtVUM7QUFuVVksOENBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gXCJAYW5ndWxhci9jb21tb24vaHR0cFwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgQXNzZXQsIEVudHJ5LCBFbnRyeUNvbGxlY3Rpb24gfSBmcm9tIFwiY29udGVudGZ1bFwiO1xyXG5pbXBvcnQgKiBhcyBtYXJrZWQgZnJvbSBcIm1hcmtlZFwiO1xyXG5pbXBvcnQgeyBlbXB0eSwgT2JzZXJ2YWJsZSwgdGltZXIgfSBmcm9tIFwicnhqc1wiO1xyXG5pbXBvcnQge1xyXG4gIGNhdGNoRXJyb3IsXHJcbiAgZGVsYXlXaGVuLFxyXG4gIG1hcCxcclxuICByZXRyeVdoZW4sXHJcbiAgc2hhcmVSZXBsYXksXHJcbiAgdGFwLFxyXG4gIHRpbWVvdXRcclxufSBmcm9tIFwicnhqcy9vcGVyYXRvcnNcIjtcclxuaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tIFwiLi4vLi4vZW52aXJvbm1lbnRzL2Vudmlyb25tZW50LnByb2RcIjtcclxuaW1wb3J0IHsgU2V0dGluZ3NTZXJ2aWNlIH0gZnJvbSBcIi4vc2V0dGluZ3Muc2VydmljZVwiO1xyXG5cclxuaW1wb3J0IHsgRXZlbnRJdGVtIH0gZnJvbSBcIi4uL21vZGVscy9ldmVudC1pdGVtLm1vZGVsXCI7XHJcbmltcG9ydCB7IEluZm9JdGVtIH0gZnJvbSBcIi4uL21vZGVscy9pbmZvLWl0ZW0ubW9kZWxcIjtcclxuaW1wb3J0IHsgU2ltcGxlQ29udGVudCB9IGZyb20gXCIuLi9tb2RlbHMvc2ltcGxlLWNvbnRlbnQubW9kZWxcIjtcclxuaW1wb3J0IHsgU3BlYWtlciB9IGZyb20gXCIuLi9tb2RlbHMvc3BlYWtlci5tb2RlbFwiO1xyXG5pbXBvcnQgeyBXb3Jrc2hvcCB9IGZyb20gXCIuLi9tb2RlbHMvd29ya3Nob3AubW9kZWxcIjtcclxuXHJcbmltcG9ydCAqIGFzIGRpYWxvZyBmcm9tIFwidWkvZGlhbG9nc1wiO1xyXG5cclxuZXhwb3J0IGVudW0gRXZlbnRDb250ZW50VHlwZXMge1xyXG4gIFNQRUFLRVIgPSBcInNwZWFrZXJcIixcclxuICBXT1JLU0hPUCA9IFwid29ya3Nob3BcIixcclxuICBFVkVOVF9JVEVNID0gXCJldmVudEl0ZW1cIixcclxuICBTSU1QTEVfQ09OVEVOVCA9IFwic2ltcGxlQ29udGVudFwiLFxyXG4gIElORk9fSVRFTSA9IFwiaW5mb0l0ZW1cIlxyXG59XHJcblxyXG5leHBvcnQgZW51bSBFdmVudEl0ZW1UeXBlIHtcclxuICBOR1BPTEFORCA9IFwibmdQb2xhbmRcIixcclxuICBKU1BPTEFORCA9IFwianNQb2xhbmRcIlxyXG59XHJcblxyXG5ASW5qZWN0YWJsZSh7XHJcbiAgcHJvdmlkZWRJbjogXCJyb290XCJcclxufSlcclxuZXhwb3J0IGNsYXNzIENvbnRlbnRmdWxTZXJ2aWNlIHtcclxuICBwcml2YXRlIHJlYWRvbmx5IENPTlRFTlRGVUxfVVJMID0gXCJodHRwOi8vY2RuLmNvbnRlbnRmdWwuY29tXCI7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBDT05URU5URlVMX1VSTF9FTlRSSUVTID0gYCR7dGhpcy5DT05URU5URlVMX1VSTH0vc3BhY2VzLyR7XHJcbiAgICBlbnZpcm9ubWVudC5jb250ZW50ZnVsLnNwYWNlSWRcclxuICB9L2Vudmlyb25tZW50cy9tYXN0ZXIvZW50cmllcz9hY2Nlc3NfdG9rZW49JHtlbnZpcm9ubWVudC5jb250ZW50ZnVsLnRva2VufWA7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgc2V0dGluZ3M6IFNldHRpbmdzU2VydmljZSwgcHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50KSB7fVxyXG5cclxuICBnZXRDb250ZW50ZnVsVXJsRW50cnkoZW50cnlJZDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIHJldHVybiBgaHR0cDovL2Nkbi5jb250ZW50ZnVsLmNvbS9zcGFjZXMvJHtcclxuICAgICAgZW52aXJvbm1lbnQuY29udGVudGZ1bC5zcGFjZUlkXHJcbiAgICB9L2Vudmlyb25tZW50cy9tYXN0ZXIvZW50cmllcy8ke2VudHJ5SWR9P2FjY2Vzc190b2tlbj0ke1xyXG4gICAgICBlbnZpcm9ubWVudC5jb250ZW50ZnVsLnRva2VuXHJcbiAgICB9YDtcclxuICB9XHJcblxyXG4gIGdldENvbnRlbnRmdWxVcmxQYXJhbWV0ZXJzKHBhcmFtczoge30pOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHBhcmFtcylcclxuICAgICAgLm1hcCgoW2tleSwgdmFsXSkgPT4gYCR7a2V5fT0ke3ZhbH1gKVxyXG4gICAgICAuam9pbihcIiZcIik7XHJcbiAgfVxyXG5cclxuICBnZXRJbmZvSXRlbXMoaG93TWFueTogbnVtYmVyKTogT2JzZXJ2YWJsZTxBcnJheTxJbmZvSXRlbT4+IHtcclxuICAgIGNvbnN0IHF1ZXJ5ID0ge1xyXG4gICAgICBjb250ZW50X3R5cGU6IEV2ZW50Q29udGVudFR5cGVzLklORk9fSVRFTSxcclxuICAgICAgbG9jYWxlOiB0aGlzLnNldHRpbmdzLmdldExvY2FsZSgpLFxyXG4gICAgICBvcmRlcjogXCJmaWVsZHMub3JkZXJcIixcclxuICAgICAgbGltaXQ6IGhvd01hbnlcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuaHR0cFxyXG4gICAgICAuZ2V0KFxyXG4gICAgICAgIGAke3RoaXMuQ09OVEVOVEZVTF9VUkxfRU5UUklFU30mJHt0aGlzLmdldENvbnRlbnRmdWxVcmxQYXJhbWV0ZXJzKFxyXG4gICAgICAgICAgcXVlcnlcclxuICAgICAgICApfWAsXHJcbiAgICAgICAgeyByZXNwb25zZVR5cGU6IFwianNvblwiIH1cclxuICAgICAgKVxyXG4gICAgICAucGlwZShcclxuICAgICAgICBtYXAoKGVudHJpZXM6IEVudHJ5Q29sbGVjdGlvbjxJbmZvSXRlbT4pID0+IHtcclxuICAgICAgICAgIHJldHVybiBlbnRyaWVzLml0ZW1zLm1hcCgoaXRlbTogRW50cnk8YW55PikgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEluZm9JdGVtKFxyXG4gICAgICAgICAgICAgIGl0ZW0uZmllbGRzLnRpdGxlLFxyXG4gICAgICAgICAgICAgIGl0ZW0uZmllbGRzLm9yZHJlLFxyXG4gICAgICAgICAgICAgIGl0ZW0uZmllbGRzLmljb24sXHJcbiAgICAgICAgICAgICAgaXRlbS5maWVsZHMuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgaXRlbS5maWVsZHMudXJsTGlua1xyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgKTtcclxuICB9XHJcblxyXG4gIGdldEV2ZW50SXRlbXMoXHJcbiAgICBob3dNYW55OiBudW1iZXIsXHJcbiAgICB0eXBlOiBFdmVudEl0ZW1UeXBlXHJcbiAgKTogT2JzZXJ2YWJsZTxBcnJheTxFdmVudEl0ZW0+PiB7XHJcbiAgICBjb25zdCBxdWVyeSA9IHtcclxuICAgICAgY29udGVudF90eXBlOiBFdmVudENvbnRlbnRUeXBlcy5FVkVOVF9JVEVNLFxyXG4gICAgICBsb2NhbGU6IHRoaXMuc2V0dGluZ3MuZ2V0TG9jYWxlKCksXHJcbiAgICAgIFwiZmllbGRzLnR5cGVcIjogdHlwZSxcclxuICAgICAgb3JkZXI6IFwiZmllbGRzLnN0YXJ0RGF0ZVwiLFxyXG4gICAgICBsaW1pdDogaG93TWFueVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5odHRwXHJcbiAgICAgIC5nZXQoXHJcbiAgICAgICAgYCR7dGhpcy5DT05URU5URlVMX1VSTF9FTlRSSUVTfSYke3RoaXMuZ2V0Q29udGVudGZ1bFVybFBhcmFtZXRlcnMoXHJcbiAgICAgICAgICBxdWVyeVxyXG4gICAgICAgICl9YCxcclxuICAgICAgICB7IHJlc3BvbnNlVHlwZTogXCJqc29uXCIgfVxyXG4gICAgICApXHJcbiAgICAgIC5waXBlKFxyXG4gICAgICAgIG1hcCgoZW50cmllczogRW50cnlDb2xsZWN0aW9uPEV2ZW50SXRlbT4pID0+IHtcclxuICAgICAgICAgIGxldCBhc3NldHM6IEFycmF5PEFzc2V0PiA9IG51bGw7XHJcbiAgICAgICAgICBsZXQgbGlua3M6IEFycmF5PEVudHJ5PGFueT4+ID0gbnVsbDtcclxuXHJcbiAgICAgICAgICBpZiAoZW50cmllcy5pbmNsdWRlcykge1xyXG4gICAgICAgICAgICBhc3NldHMgPSBlbnRyaWVzLmluY2x1ZGVzLkFzc2V0O1xyXG4gICAgICAgICAgICBsaW5rcyA9IGVudHJpZXMuaW5jbHVkZXMuRW50cnk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgcmV0dXJuIGVudHJpZXMuaXRlbXMubWFwKChpdGVtOiBFbnRyeTxhbnk+KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBzcGVha2VyID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKGxpbmtzICYmIGl0ZW0uZmllbGRzLnByZXNlbnRlcikge1xyXG4gICAgICAgICAgICAgIHNwZWFrZXIgPSB0aGlzLmdldEVudHJ5QnlJZChsaW5rcywgaXRlbS5maWVsZHMucHJlc2VudGVyLnN5cy5pZCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxldCBzcGVha2VyUGhvdG8gPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAoc3BlYWtlcikge1xyXG4gICAgICAgICAgICAgIHNwZWFrZXJQaG90byA9IHRoaXMuZ2V0QXNzZXRCeUlkKFxyXG4gICAgICAgICAgICAgICAgYXNzZXRzLFxyXG4gICAgICAgICAgICAgICAgc3BlYWtlci5maWVsZHMucGhvdG8uc3lzLmlkXHJcbiAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBFdmVudEl0ZW0oXHJcbiAgICAgICAgICAgICAgaXRlbS5maWVsZHMudGl0bGUsXHJcbiAgICAgICAgICAgICAgaXRlbS5maWVsZHMudHlwZSxcclxuICAgICAgICAgICAgICBpdGVtLmZpZWxkcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICBpdGVtLmZpZWxkcy5zaG9ydERlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgIGl0ZW0uZmllbGRzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgIGl0ZW0uZmllbGRzLnN0YXJ0RGF0ZSxcclxuICAgICAgICAgICAgICBpdGVtLmZpZWxkcy5lbmREYXRlLFxyXG4gICAgICAgICAgICAgIHNwZWFrZXJcclxuICAgICAgICAgICAgICAgID8gbmV3IFNwZWFrZXIoXHJcbiAgICAgICAgICAgICAgICAgICAgc3BlYWtlci5maWVsZHMubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBzcGVha2VyLmZpZWxkcy5yb2xlLFxyXG4gICAgICAgICAgICAgICAgICAgIHNwZWFrZXIuZmllbGRzLmJpbyxcclxuICAgICAgICAgICAgICAgICAgICBzcGVha2VyUGhvdG8gPyBzcGVha2VyUGhvdG8uZmllbGRzLmZpbGUudXJsIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICAgICAgICAgIHNwZWFrZXJQaG90byA/IHNwZWFrZXJQaG90by5maWVsZHMudGl0bGUgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgc3BlYWtlclBob3RvID8gc3BlYWtlclBob3RvLmZpZWxkcy5kZXNjcmlwdGlvbiA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgICAgICBzcGVha2VyLmZpZWxkcy5lbWFpbCxcclxuICAgICAgICAgICAgICAgICAgICBzcGVha2VyLmZpZWxkcy51cmxHaXRodWIsXHJcbiAgICAgICAgICAgICAgICAgICAgc3BlYWtlci5maWVsZHMudXJsTGlua2VkSW4sXHJcbiAgICAgICAgICAgICAgICAgICAgc3BlYWtlci5maWVsZHMudXJsVHdpdHRlcixcclxuICAgICAgICAgICAgICAgICAgICBzcGVha2VyLmZpZWxkcy51cmxXd3dcclxuICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pLFxyXG4gICAgICAgIHNoYXJlUmVwbGF5KCksXHJcbiAgICAgICAgdGltZW91dCgyMDAwMCksXHJcbiAgICAgICAgcmV0cnlXaGVuKChlcnJvcnM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIGVycm9ycy5waXBlKFxyXG4gICAgICAgICAgICBkZWxheVdoZW4oKCkgPT4gdGltZXIoMjAwMCkpLFxyXG4gICAgICAgICAgICB0YXAoKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmV0cnlpbmcuLi5cIik7XHJcbiAgICAgICAgICAgICAgZGlhbG9nLmFsZXJ0KFwiQsWCYWQgcG/FgmFjemVuaWFcIik7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgfVxyXG5cclxuICBnZXRTaW1wbGVDb250ZW50QnlJZChteUlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPFNpbXBsZUNvbnRlbnQ+IHtcclxuICAgIGNvbnN0IHF1ZXJ5ID0ge1xyXG4gICAgICBjb250ZW50X3R5cGU6IEV2ZW50Q29udGVudFR5cGVzLlNJTVBMRV9DT05URU5ULFxyXG4gICAgICBsb2NhbGU6IHRoaXMuc2V0dGluZ3MuZ2V0TG9jYWxlKCksXHJcbiAgICAgIFwiZmllbGRzLm15SWRcIjogbXlJZCxcclxuICAgICAgbGltaXQ6IDFcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuaHR0cFxyXG4gICAgICAuZ2V0KFxyXG4gICAgICAgIGAke3RoaXMuQ09OVEVOVEZVTF9VUkxfRU5UUklFU30mJHt0aGlzLmdldENvbnRlbnRmdWxVcmxQYXJhbWV0ZXJzKFxyXG4gICAgICAgICAgcXVlcnlcclxuICAgICAgICApfWAsXHJcbiAgICAgICAgeyByZXNwb25zZVR5cGU6IFwianNvblwiIH1cclxuICAgICAgKVxyXG4gICAgICAucGlwZShcclxuICAgICAgICBtYXAoKGVudHJpZXM6IEVudHJ5Q29sbGVjdGlvbjxTaW1wbGVDb250ZW50PikgPT4ge1xyXG4gICAgICAgICAgaWYgKGVudHJpZXMgJiYgZW50cmllcy5pdGVtcyAmJiBlbnRyaWVzLml0ZW1zWzBdKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgU2ltcGxlQ29udGVudChcclxuICAgICAgICAgICAgICBlbnRyaWVzLml0ZW1zWzBdLmZpZWxkcy5teUlkLFxyXG4gICAgICAgICAgICAgIGVudHJpZXMuaXRlbXNbMF0uZmllbGRzLnRpdGxlLFxyXG4gICAgICAgICAgICAgIGVudHJpZXMuaXRlbXNbMF0uZmllbGRzLnRleHRcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgU2ltcGxlQ29udGVudChcIjAwMFwiLCBcIm5pZSB1ZGHFgm8gc2nEmVwiLCBcIm5pZSB3eXN6xYJvIGNvxZtcIik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgKTtcclxuICB9XHJcblxyXG4gIGdldFdvcmtzaG9wcyhob3dNYW55OiBudW1iZXIpOiBPYnNlcnZhYmxlPEFycmF5PFdvcmtzaG9wPj4ge1xyXG4gICAgY29uc3QgcXVlcnkgPSB7XHJcbiAgICAgIGNvbnRlbnRfdHlwZTogRXZlbnRDb250ZW50VHlwZXMuV09SS1NIT1AsXHJcbiAgICAgIGxvY2FsZTogdGhpcy5zZXR0aW5ncy5nZXRMb2NhbGUoKSxcclxuICAgICAgb3JkZXI6IFwic3lzLmNyZWF0ZWRBdFwiLFxyXG4gICAgICBsaW1pdDogaG93TWFueVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5odHRwXHJcbiAgICAgIC5nZXQoXHJcbiAgICAgICAgYCR7dGhpcy5DT05URU5URlVMX1VSTF9FTlRSSUVTfSYke3RoaXMuZ2V0Q29udGVudGZ1bFVybFBhcmFtZXRlcnMoXHJcbiAgICAgICAgICBxdWVyeVxyXG4gICAgICAgICl9YCxcclxuICAgICAgICB7IHJlc3BvbnNlVHlwZTogXCJqc29uXCIgfVxyXG4gICAgICApXHJcbiAgICAgIC5waXBlKFxyXG4gICAgICAgIG1hcCgoZW50cmllczogRW50cnlDb2xsZWN0aW9uPGFueT4pID0+IHtcclxuICAgICAgICAgIGNvbnN0IGFzc2V0czogQXJyYXk8QXNzZXQ+ID0gZW50cmllcy5pbmNsdWRlcy5Bc3NldDtcclxuICAgICAgICAgIGNvbnN0IGxpbmtzOiBBcnJheTxFbnRyeTxhbnk+PiA9IGVudHJpZXMuaW5jbHVkZXMuRW50cnk7XHJcblxyXG4gICAgICAgICAgcmV0dXJuIGVudHJpZXMuaXRlbXMubWFwKChpdGVtOiBFbnRyeTxhbnk+KSA9PiB7XHJcbiAgICAgICAgICAgIC8vICBjb25zdCBwcm9maWxlUGhvdG86IEFzc2V0ID0gdGhpcy5nZXRBc3NldEJ5SWQoYXNzZXRzLCBpdGVtLmZpZWxkcy5waG90by5zeXMuaWQpO1xyXG4gICAgICAgICAgICBjb25zdCBzcGVha2VyID0gdGhpcy5nZXRFbnRyeUJ5SWQoXHJcbiAgICAgICAgICAgICAgbGlua3MsXHJcbiAgICAgICAgICAgICAgaXRlbS5maWVsZHMuaW5zdHJ1Y3Rvci5zeXMuaWRcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJTcGVrYWVyOiBcIiwgc3BlYWtlcik7XHJcbiAgICAgICAgICAgIGNvbnN0IHNwZWFrZXJQaG90byA9IHRoaXMuZ2V0QXNzZXRCeUlkKFxyXG4gICAgICAgICAgICAgIGFzc2V0cyxcclxuICAgICAgICAgICAgICBzcGVha2VyLmZpZWxkcy5waG90by5zeXMuaWRcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgV29ya3Nob3AoXHJcbiAgICAgICAgICAgICAgaXRlbS5maWVsZHMudGl0bGUsXHJcbiAgICAgICAgICAgICAgaXRlbS5maWVsZHMuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgbmV3IFNwZWFrZXIoXHJcbiAgICAgICAgICAgICAgICBzcGVha2VyLmZpZWxkcy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgc3BlYWtlci5maWVsZHMucm9sZSxcclxuICAgICAgICAgICAgICAgIHNwZWFrZXIuZmllbGRzLmJpbyxcclxuICAgICAgICAgICAgICAgIHNwZWFrZXJQaG90byA/IHNwZWFrZXJQaG90by5maWVsZHMuZmlsZS51cmwgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBzcGVha2VyUGhvdG8gPyBzcGVha2VyUGhvdG8uZmllbGRzLnRpdGxlIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICAgICAgc3BlYWtlclBob3RvID8gc3BlYWtlclBob3RvLmZpZWxkcy5kZXNjcmlwdGlvbiA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgIHNwZWFrZXIuZmllbGRzLmVtYWlsLFxyXG4gICAgICAgICAgICAgICAgc3BlYWtlci5maWVsZHMudXJsR2l0aHViLFxyXG4gICAgICAgICAgICAgICAgc3BlYWtlci5maWVsZHMudXJsTGlua2VkSW4sXHJcbiAgICAgICAgICAgICAgICBzcGVha2VyLmZpZWxkcy51cmxUd2l0dGVyLFxyXG4gICAgICAgICAgICAgICAgc3BlYWtlci5maWVsZHMudXJsV3d3XHJcbiAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICBpdGVtLmZpZWxkcy5zdGFydERhdGUsXHJcbiAgICAgICAgICAgICAgaXRlbS5maWVsZHMuZW5kRGF0ZSxcclxuICAgICAgICAgICAgICAwLCAvLyBUT0RPOiB6YW1pZW5pxIcgbmEgd3Nww7PFgnJ6xJlkbmVcclxuICAgICAgICAgICAgICAwLCAvLyBUT0RPOiB6YW1pZW5pxIcgbmEgd3Nww7PFgnJ6xJlkbmVcclxuICAgICAgICAgICAgICBpdGVtLmZpZWxkcy5sb2NhdGlvbkRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgIGl0ZW0uZmllbGRzLnByaWNlUGxuXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gIH1cclxuXHJcbiAgZ2V0U3BlYWtlcnMoaG93TWFueTogbnVtYmVyKTogT2JzZXJ2YWJsZTxBcnJheTxTcGVha2VyPj4ge1xyXG4gICAgY29uc3QgcXVlcnkgPSB7XHJcbiAgICAgIGNvbnRlbnRfdHlwZTogRXZlbnRDb250ZW50VHlwZXMuU1BFQUtFUixcclxuICAgICAgbG9jYWxlOiB0aGlzLnNldHRpbmdzLmdldExvY2FsZSgpLFxyXG4gICAgICBvcmRlcjogXCJzeXMuY3JlYXRlZEF0XCIsXHJcbiAgICAgIGxpbWl0OiBob3dNYW55XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiB0aGlzLmh0dHBcclxuICAgICAgLmdldChcclxuICAgICAgICBgJHt0aGlzLkNPTlRFTlRGVUxfVVJMX0VOVFJJRVN9JiR7dGhpcy5nZXRDb250ZW50ZnVsVXJsUGFyYW1ldGVycyhcclxuICAgICAgICAgIHF1ZXJ5XHJcbiAgICAgICAgKX1gLFxyXG4gICAgICAgIHsgcmVzcG9uc2VUeXBlOiBcImpzb25cIiB9XHJcbiAgICAgIClcclxuICAgICAgLnBpcGUoXHJcbiAgICAgICAgbWFwKChlbnRyaWVzOiBFbnRyeUNvbGxlY3Rpb248YW55PikgPT4ge1xyXG4gICAgICAgICAgY29uc3QgYXNzZXRzOiBBcnJheTxBc3NldD4gPSBlbnRyaWVzLmluY2x1ZGVzLkFzc2V0O1xyXG5cclxuICAgICAgICAgIHJldHVybiBlbnRyaWVzLml0ZW1zLm1hcCgoaXRlbTogRW50cnk8YW55PikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwcm9maWxlUGhvdG86IEFzc2V0ID0gdGhpcy5nZXRBc3NldEJ5SWQoXHJcbiAgICAgICAgICAgICAgYXNzZXRzLFxyXG4gICAgICAgICAgICAgIGl0ZW0uZmllbGRzLnBob3RvLnN5cy5pZFxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBTcGVha2VyKFxyXG4gICAgICAgICAgICAgIGl0ZW0uZmllbGRzLm5hbWUsXHJcbiAgICAgICAgICAgICAgaXRlbS5maWVsZHMucm9sZSxcclxuICAgICAgICAgICAgICBpdGVtLmZpZWxkcy5iaW8sXHJcbiAgICAgICAgICAgICAgcHJvZmlsZVBob3RvID8gcHJvZmlsZVBob3RvLmZpZWxkcy5maWxlLnVybCA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICBwcm9maWxlUGhvdG8gPyBwcm9maWxlUGhvdG8uZmllbGRzLnRpdGxlIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICAgIHByb2ZpbGVQaG90byA/IHByb2ZpbGVQaG90by5maWVsZHMuZGVzY3JpcHRpb24gOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgaXRlbS5maWVsZHMuZW1haWwsXHJcbiAgICAgICAgICAgICAgaXRlbS5maWVsZHMudXJsR2l0aHViLFxyXG4gICAgICAgICAgICAgIGl0ZW0uZmllbGRzLnVybExpbmtlZEluLFxyXG4gICAgICAgICAgICAgIGl0ZW0uZmllbGRzLnVybFR3aXR0ZXIsXHJcbiAgICAgICAgICAgICAgaXRlbS5maWVsZHMudXJsV3d3XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gIH1cclxuXHJcbiAgbWFya2Rvd25Ub0h0bWwobWQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIG1hcmtlZChtZCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEFzc2V0QnlJZChhc3NldEFycmF5OiBBcnJheTxBc3NldD4sIGlkOiBzdHJpbmcpOiBhbnkge1xyXG4gICAgaWYgKGFzc2V0QXJyYXkgJiYgYXNzZXRBcnJheS5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnN0IG5ld0FycmF5ID0gYXNzZXRBcnJheS5maWx0ZXIoKGl0ZW06IEFzc2V0KSA9PiBpdGVtLnN5cy5pZCA9PT0gaWQpO1xyXG4gICAgICBpZiAobmV3QXJyYXkgJiYgbmV3QXJyYXkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJldHVybiBuZXdBcnJheVswXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7fTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0QXNzZXRzQnlJZHMoYXNzZXRBcnJheTogQXJyYXk8QXNzZXQ+LCBpZHM6IEFycmF5PHN0cmluZz4pOiBhbnkge1xyXG4gICAgaWYgKGFzc2V0QXJyYXkgJiYgYXNzZXRBcnJheS5sZW5ndGggPiAwICYmIGlkcyAmJiBpZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBjb25zdCBuZXdBcnJheSA9IGFzc2V0QXJyYXkuZmlsdGVyKChpdGVtOiBBc3NldCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBpZHMuaW5jbHVkZXMoaXRlbS5zeXMuaWQpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiBuZXdBcnJheTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge307XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEVudHJ5QnlJZChlbnRyaWVzQXJyYXk6IEFycmF5PEVudHJ5PGFueT4+LCBpZDogc3RyaW5nKTogYW55IHtcclxuICAgIGlmIChlbnRyaWVzQXJyYXkgJiYgZW50cmllc0FycmF5Lmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc3QgbmV3QXJyYXkgPSBlbnRyaWVzQXJyYXkuZmlsdGVyKFxyXG4gICAgICAgIChpdGVtOiBFbnRyeTxhbnk+KSA9PiBpdGVtLnN5cy5pZCA9PT0gaWRcclxuICAgICAgKTtcclxuICAgICAgaWYgKG5ld0FycmF5ICYmIG5ld0FycmF5Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gbmV3QXJyYXlbMF07XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge307XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEVudHJpZXNCeUNvbnRlbnRUeXBlKFxyXG4gICAgZW50cmllc0FycmF5OiBBcnJheTxFbnRyeTxhbnk+PixcclxuICAgIGNvbnRlbnRUeXBlOiBFdmVudENvbnRlbnRUeXBlc1xyXG4gICk6IGFueSB7XHJcbiAgICBpZiAoZW50cmllc0FycmF5ICYmIGVudHJpZXNBcnJheS5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnN0IG5ld0FycmF5ID0gZW50cmllc0FycmF5LmZpbHRlcihcclxuICAgICAgICAoaXRlbTogRW50cnk8YW55PikgPT4gaXRlbS5zeXMuY29udGVudFR5cGUuc3lzLmlkID09PSBjb250ZW50VHlwZVxyXG4gICAgICApO1xyXG4gICAgICBpZiAobmV3QXJyYXkgJiYgbmV3QXJyYXkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJldHVybiBuZXdBcnJheTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7fTtcclxuICB9XHJcbn1cclxuIl19